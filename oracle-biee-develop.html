<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="author" content="Poon" />
    <meta name="robots" content="index, follow"/>

    <meta property="og:title" content="Oracle BIEE 经验总结"/>
    <meta property="og:url" content="/oracle-biee-develop.html"/>
    <meta property="og:site_name" content="i.M.X.3"/>
    <meta property="og:type" content="article"/>

    <link rel="canonical" href="/oracle-biee-develop.html" />

    <title>Oracle BIEE 经验总结 | i.M.X.3</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" />

    <link rel="stylesheet" type="text/css" href="/theme/css/main.css" />

    <script type="text/javascript">var switchTo5x=true;</script>
    <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">
        stLight.options({
            publisher: "7470bcd0-1833-4a2b-a25f-c4a233bdfced",
            doNotHash: false,
            doNotCopy: false,
            hashAddressBar: false
        });
    </script>
</head>

<body id="index">

<script>
(function(){
    var bp = document.createElement('script');
    bp.src = '//push.zhanzhang.baidu.com/push.js';
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
    <div class="row-fluid">
        <div class="span10 offset1">
            <header id="banner" >
                <h1>
                        <a href="/"> i.M.X.3 </a> 
<!-- /# 
 
                        <strong>
                            <span style="font-size:12px;vertical-align:bottom">Be a Coder,Lifehacker,Storyteller </span>
                        </strong>
 -->
                </h1>
                <nav class="navbar">
                    <div class="navbar-inner">
                        <ul class="nav">
                            <li ><a href="tags.html">Tags</a></li>
                            <li ><a href="about.html">About</a></li>
                        </ul>

<script>
  (function() {
    var cx = '005973619447881484970:jf4jwrpc3tg';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div id="google-custom-search" class="nav">
    <gcse:search></gcse:search>
</div>
                    </div>
                </nav>
            </header><!-- /#banner -->
        </div>
    </div>

    <div class="row-fluid">
        <div class="span10 offset1">
            <div class="row-fluid">
<div class="span10 offset1">
  <section>
    <article>
      <header>
        <h1 class="entry-title">
          <a href="/oracle-biee-develop.html" rel="bookmark"
             title="Permalink to Oracle BIEE 经验总结">Oracle BIEE 经验总结</a></h1>
      </header>
      <div class="entry-content">
<footer class="post-info">
    <address class="vcard author">
        by <a class="url fn" href="/author/poon.html">Poon</a>
    </address>

    in <a href="/category/tech.html">Tech</a>

    on 2015-11-27

        |
        tags:         <a href="/tag/oracle.html">oracle</a>
        <a href="/tag/biee.html">biee</a>
        <a href="/tag/bi.html">BI</a>


        |
        <a href="/oracle-biee-develop.html#disqus_thread">comments</a>

    
</footer><!-- /.post-info -->
        <div class="sharethis-top">
          <span class='st_fblike_hcount' displayText='Facebook Like'></span>
          <span class='st_plusone_hcount' displayText='Google +1'></span>
          <span class='st_twitter_hcount' displayText='Tweet'></span>
          <span class='st_email_hcount' displayText='Email'></span>
        </div>

        <nav class="toc">
        <div class="toc">
<ul>
<li><a href="#0">0.前言</a></li>
<li><a href="#1">1.经验技巧</a><ul>
<li><a href="#11physical-layer-with">1.1.physical layer 不支持with子句</a></li>
<li><a href="#12session-variable">1.2.Session variable 可以放到物理层</a></li>
<li><a href="#13bieetimestampnnnn">1.3.BIEE的timestamp类型的日期运算：推算前n天，后n天，前n月，后n月等。</a></li>
<li><a href="#14biee">1.4.利用biee的提示,将展示变量传递到会话变量</a><ul>
<li><a href="#141">1.4.1.背景：</a></li>
<li><a href="#142">1.4.2.设计：</a></li>
<li><a href="#143-tips">1.4.3. 其他tips：</a></li>
</ul>
</li>
<li><a href="#15-biee">1.5. BIEE分析报表的格式套用/批量设置解答：</a></li>
<li><a href="#16-oracle-biee">1.6  Oracle BIEE从开发迁移到生产时，如何处置修改配置这些麻烦事？</a><ul>
<li><a href="#161-rpd">1.6.1 RPD 密码的修改</a></li>
</ul>
</li>
<li><a href="#17-weblogic-jndi-xml">1.7 weblogic －服务－数据源－中的 jndi 对应后台哪个xml配置文件？</a></li>
<li><a href="#18-biee">1.8 BIEE报表如何实现单元格绿白相间？</a></li>
<li><a href="#oracle-biee-try-it-live">oracle biee try it live 的地址是？</a><ul>
<li><a href="#odbcini">odbc.ini 有什么用？</a></li>
<li><a href="#162-ip">1.6.2 服务器ip / 端口的修改</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#2">2.异常处理</a><ul>
<li><a href="#21-ora-32034unsupported-use-of-with-clause-at-oci-call-ocistmtexecute">2.1 ora-32034:unsupported use of with clause at OCI call OCIstmtExecute.</a></li>
<li><a href="#22-nqserror43119-nqserror42039-report-by">2.2 nqserror:43119 nqserror:42039: report 总计函数的by子句中的列必须在选择列表中。</a></li>
<li><a href="#23-biee-catalog">2.3 biee catalog 指向 不正确如何解决？</a></li>
<li><a href="#24-rpd-repository-rpd">2.4 加载的rpd 不是我们想要的repository ， 怎么改成我们要的rpd?</a></li>
</ul>
</li>
</ul>
</div>
        </nav>

        
<h1 id="0">0.前言</h1>
<p>使用biee开发前前后有也有两年多了，对oracle这套产品，也有一点小小心得，在此总结一下，抛砖引玉。持续更新中...</p>
<h1 id="1">1.经验技巧</h1>
<h3 id="11physical-layer-with">1.1.physical layer 不支持with子句</h3>
<p>如果你打算将：
with tab as（  ） 这样的子句放到物理表视图中，那么rpd将会让你失望。因为rpd中的视图实质上是一个形如 select * from ( ) tab 的子查询。而如果你要将with放到子查询中，将会影响biee前端自动生成with 子句。如果你要用with子句写查询语句，简易先 create view yourviewname as 来建立一个视图，然后再在物理层中调用。</p>
<h3 id="12session-variable">1.2.Session variable 可以放到物理层</h3>
<p>你可以将VALUEOF(NQSESSION.RQVAR) 在物理层中引用Session Variable，然后通过在前端使用request variable来修改session variable的值。</p>
<h3 id="13bieetimestampnnnn">1.3.BIEE的timestamp类型的日期运算：推算前n天，后n天，前n月，后n月等。</h3>
<p>使用timestampdiff（）函数，可控制的粒度可以细到秒，粗到年！</p>
<h3 id="14biee">1.4.利用biee的提示,将展示变量传递到会话变量</h3>
<h4 id="141">1.4.1.背景：</h4>
<ol>
<li>一个服务器变量 TABLE_NAME_INOUT，又叫 session variable , 对应前端是 request variable  ， 该变量需要保存一个表名，该表名具有INOUT的特征。</li>
<li>在业务上，为业务人员设计了一个提示框，二选1，对于业务，是切换客户层级，而对于后台，是切换数据表。</li>
<li>关系梳理： 用户提示：客户层级切换  &lt;—&gt; 后台表名切换</li>
<li>需要在这中间 添加一个转换机制 ：输入 ： 储蓄/资产 ， 转换为 ： DPSIT/ASSET</li>
</ol>
<h4 id="142">1.4.2.设计：</h4>
<ol>
<li>
<p>rpd: NQ_SESSION.TABLE_NAME_INOUT</p>
</li>
<li>
<p>analytics 提示a设计：表示变量pv: 作为 转换到表名的输入。该提示a 不能设计为 请求变量， 否则传递无效。</p>
</li>
<li>
<p>analytics 提示b设计：请求变量：TABLE_NAME_INOUT ,  列公式设计：</p>
<p>case when pv=‘xxx' then ‘dfadfa’
when pv =‘yyy’ then ‘dfads'
end</p>
</li>
<li>
<p>注意事项: 如果 pv变量传递的是字符串，那么需要用 单引号引起来。如： ‘@{pv}’</p>
</li>
<li>
<p>define pv = ‘xxx’ ; define rqv = case when pv …. end </p>
</li>
<li>
<p>列公式不是必需的。可以用 ‘anychar’ 代替。</p>
</li>
<li>
<p>默认值的设置，一定要正确。</p>
</li>
</ol>
<h4 id="143-tips">1.4.3. 其他tips：</h4>
<ol>
<li>默认值的填写： 如果是服务器变量，直接填写 : var_name , 不需要 valueof , 也不需要 nq_session </li>
<li>如果是 变量表达式：就是表示变量：格式：@{pv} 即可。有默认值也可以添加默认值。</li>
</ol>
<h3 id="15-biee">1.5. BIEE分析报表的格式套用/批量设置解答：</h3>
<ol>
<li>
<p>把格式设置存为默认会发生什么？</p>
<p>如果把格式存为默认，那么系统中的所有报表都将会采用该设置作为默认值。例如，我们把一个整数列的格式设置为两位小数，那么对于其他报表，如果没有特别设置，都将采用该设置作为默认值。
2. 从已经保存的报表中借用格式，套用到新报表中，是怎么一个规则？</p>
<p>以下是官方说法：</p>
<p>Applying Formatting from Columns <a href="http://docs.oracle.com/cd/E28280_01/bi.1111/e10544/format.htm#BIEUG1192i">官方链接</a>
This functionality works best for views when attribute, measure, or hierarchical column numbers align precisely or for a single column template that can be applied to all columns. If a single column exists in the saved analysis, then its formatting is applied to all columns in the tables, pivot tables, and trellises of the target analysis.</p>
<p>For multiple columns, formatting is applied positionally, from left to right for column headings and values. A column that exceeds the number in the saved analysis gets the closest column's format repeated. For example, suppose the saved analysis contains four columns formatted with these colors in this order: red, green, blue, yellow. In the target analysis, its six columns would acquire these colors in this order: red, green, blue, yellow, yellow, yellow.</p>
</li>
</ol>
<p>解析：</p>
<ol>
<li>如果保存的报表只有一列,那么新报表的格式将全部采用那列的格式。</li>
<li>如果属性列，度量列和层级列的数量和对齐都是一致的，那么将会一一匹配。</li>
<li>如果列数不等，新报表列数多，那么新报表中不能匹配的列将重复最后一列。比如，4列老报表的列颜色设置为 红绿蓝黄，那么6列新报表的颜色为红绿蓝黄黄黄！</li>
</ol>
<h2 id="16-oracle-biee">1.6  Oracle BIEE从开发迁移到生产时，如何处置修改配置这些麻烦事？</h2>
<h3 id="161-rpd">1.6.1 RPD 密码的修改</h3>
<p>连接池越多，要改的密码就越多！你愿意每次投产，都要做这种没有技术含量，而风险又大的活？of course not !
通过使用 admintool.exe /command 命令，通过配置的方式，修改密码，只需要执行批处理即可！</p>
<p>a. run.bat 批处理脚本： </p>
<pre><code>set ORACLE_BI_LANG=en
set path=%path%;"C:\Program Files\Oracle Business Intelligence Enterprise Edition Plus Client 2 2\oraclebi\orahome\bifoundation\server\bin"
REM set ORACLE_HOME=C:\Program Files\Oracle Business Intelligence Enterprise Edition Plus Client 2 2\oraclebi\orahome
REM set ORACLE_INSTANCE=C:\Program Files\Oracle Business Intelligence Enterprise Edition Plus Client 2 2\oraclebi\orainst
REM set ORACLE_BI_APPLICATION=coreapplication
AdminTool.exe /command D:\poon\cases\rpd\PRDUCTION\AutoChangeAcct\prd.txt
</code></pre>
<p>b.  prd.txt 命令内容：</p>
<pre><code>// 离线打开rpd
OpenOffline D:\poon\cases\rpd\PRDUCTION\AutoChangeAcct\rpd001.rpd passwordhere

 //设置连接池

SetProperty "Connection Pool" "1_5C"."5C_BIEEMGROPR" "DSN" "(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=bieehost)(PORT=1528)))(CONNECT_DATA=(SERVICE_NAME=biee)))"

// 设置用户名
SetProperty "Connection Pool" "1_5C"."5C_BIEEMGROPR" "User" "bieemgropr"

//设置密码
SetProperty "Connection Pool" "1_5C"."5C_BIEEMGROPR" "Password" "passwordhere"

// 保存rpd
Save
</code></pre>
<h2 id="17-weblogic-jndi-xml">1.7 weblogic －服务－数据源－中的 jndi 对应后台哪个xml配置文件？</h2>
<pre><code>${BIEE_HOME}/user_projects/domains/bifoundation_domain/config/jdbc/bieeds-jdbc.xml
</code></pre>
<p>另外，连接池url的格式为：</p>
<pre><code>jdbc:oracle:thin:@ip_or_domain:port/sid
</code></pre>
<h2 id="18-biee">1.8 BIEE报表如何实现单元格绿白相间？</h2>
<p>如图，在结果中，点击表属性。如图：</p>
<p><img alt="设置biee表单元格样式" src="img/00001-04.jpg"/></p>
<h2 id="oracle-biee-try-it-live">oracle biee try it live 的地址是？</h2>
<p>2015-11-21 10:24</p>
<p>地址： </p>
<pre><code>http://slc02ojq.oracle.com:7780/analytics/
</code></pre>
<p>帐号密码:</p>
<pre><code>Prodney/Admin123
</code></pre>
<p>参考：</p>
<pre><code>https://community.oracle.com/message/13342070
</code></pre>
<p>备注：</p>
<p>slc02ojq  works
slc02ojy  works</p>
<p><s>slc02oky</s></p>
<p>slc02ojl fail
slc02ojw fail
slc02ojr fail 
slc02oka fail</p>
<h3 id="odbcini">odbc.ini 有什么用？</h3>
<p>odbc.ini 是用户配置展示层到bi server层的数据连接的。我们知道，biee有展示服务，有bi service 服务，一个是展示层，一个是服务层。这两层数据之间数据如何通信？就是通过odbc数据源配置，使得biee的展示层能够存取后台数据库的数据。</p>
<h3 id="162-ip">1.6.2 服务器ip / 端口的修改</h3>
<p>不要再用ip 了 ！ 赶紧改用域名把！ 把你的开发主机 的hosts 改一下，采用与生产环境主机相同的域名！就不用每次都把ip改来改去了。</p>
<h1 id="2">2.异常处理</h1>
<h3 id="21-ora-32034unsupported-use-of-with-clause-at-oci-call-ocistmtexecute">2.1 ora-32034:unsupported use of with clause at OCI call OCIstmtExecute.</h3>
<p>解决办法：检查rpd物理层子查询中是否有with子句。有的话，改成子查询的形式。</p>
<h3 id="22-nqserror43119-nqserror42039-report-by">2.2 nqserror:43119 nqserror:42039: report 总计函数的by子句中的列必须在选择列表中。</h3>
<p>该异常我理解为：select dim... report_sum( measure by dim... ) from table ...
dim... 没有对应上！</p>
<p>如何排除该异常：把视图中exclude掉的字段，试验性地添加到include列中。如果你不希望挪上去的列展示出来，再把该列设置为隐藏即可！</p>
<p><s>本文最后更新于: 2015-11-09 14:46</s></p>
<p><s>本文最后更新于: 2015-11-10 11:37</s></p>
<p><s>本文最后更新于: 2015-11-10 15:57</s></p>
<p>本文最后更新于: 2015-11-17 15:00</p>
<h3 id="23-biee-catalog">2.3 biee catalog 指向 不正确如何解决？</h3>
<p>修改 instanceconfig.xml , 将 <catalogpath> 标签中的路径改为正确的路径。</catalogpath></p>
<h3 id="24-rpd-repository-rpd">2.4 加载的rpd 不是我们想要的repository ， 怎么改成我们要的rpd?</h3>
<p>修改 NQSConfig.INI</p>
<pre><code>Star = yourRPDname.rpd , DEAULT;
</code></pre>
<p>如果rpd通过前端em上传的，通常会出现rpd名字被修改，导致引用不正确的情况。</p>

        <div class="sharethis-bottom">
          <span class='st_fblike_hcount' displayText='Facebook Like'></span>
          <span class='st_plusone_hcount' displayText='Google +1'></span>
          <span class='st_twitter_hcount' displayText='Tweet'></span>
          <span class='st_email_hcount' displayText='Email'></span>
        </div>
      </div><!-- /.entry-content -->
      <div class="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_identifier = "oracle-biee-develop.html";
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//gitwillpoonimx3.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      </div>

    </article>
  </section>
</div>
            </div>
        </div>
    </div>

    <footer id="site-footer">
        <div class="row-fluid">
            <div class="span10 offset1">
                <address>
                    <p>
                        This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                    </p>
                    <p>
                        <a href="http://github.com/jsliang/pelican-fresh/">Fresh</a> is a responsive theme designed by <a href="http://jsliang.com/">jsliang</a> and <a href="https://github.com/jsliang/pelican-fresh/graphs/contributors">contributors</a>.
                        Special thanks to <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a> and <a href="http://getbootstrap.com/">Twitter Bootstrap</a>.
                    </p>
                </address>
            </div>
        </div>
    </footer>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-69868761-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'gitwillpoonimx3';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>
</body>
</html>